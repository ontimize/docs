<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/newdocs/v1/assets/css/just-the-docs-default.css"> <style type="text/css"> .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.external):nth-child(10) > .nav-list-link { display: block; font-weight: 600; text-decoration: none; background-image: linear-gradient(-90deg, #eaeaea 0%, rgba(234, 234, 234, 0.8) 80%, rgba(234, 234, 234, 0) 100%); } .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:nth-child(10) > .nav-list-expander svg { transform: rotate(-90deg); } .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:nth-child(10) > .nav-list { display: block; } .site-nav > .nav-category-list > .nav-list-item > .nav-list-expander svg { transform: rotate(-90deg); } .site-nav > .nav-category-list > .nav-list-item > .nav-list { display: block; } </style> <script src="/newdocs/v1/assets/js/vendor/lunr.min.js"></script> <script src="/newdocs/v1/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Security System | Ontimize Boot</title> <meta name="generator" content="Jekyll v4.3.2" /> <meta property="og:title" content="Security System" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Table of Contents" /> <meta property="og:description" content="Table of Contents" /> <link rel="canonical" href="https://ontimize.github.io/newdocs/v1/basics/security/" /> <meta property="og:url" content="https://ontimize.github.io/newdocs/v1/basics/security/" /> <meta property="og:site_name" content="Ontimize Boot" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Security System" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Table of Contents","headline":"Security System","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ontimize.github.io/newdocs/v1/assets/icons/logo-ontimize-blanco.png"}},"url":"https://ontimize.github.io/newdocs/v1/basics/security/"}</script> <!-- End Jekyll SEO tag --> <!-- start custom head snippets --> <link rel="apple-touch-icon" sizes="57x57" href="https://ontimize.github.io/newdocs/v1/assets/icons/apple-icon-57x57.png?v=M44lzPylqQ"> <link rel="apple-touch-icon" sizes="60x60" href="https://ontimize.github.io/newdocs/v1/assets/icons/apple-icon-60x60.png?v=M44lzPylqQ"> <link rel="apple-touch-icon" sizes="72x72" href="https://ontimize.github.io/newdocs/v1/assets/icons/apple-icon-72x72.png?v=M44lzPylqQ"> <link rel="apple-touch-icon" sizes="76x76" href="https://ontimize.github.io/newdocs/v1/assets/icons/apple-icon-76x76.png?v=M44lzPylqQ"> <link rel="apple-touch-icon" sizes="114x114" href="https://ontimize.github.io/newdocs/v1/assets/icons/apple-icon-114x114.png?v=M44lzPylqQ"> <link rel="apple-touch-icon" sizes="120x120" href="https://ontimize.github.io/newdocs/v1/assets/icons/apple-icon-120x120.png?v=M44lzPylqQ"> <link rel="apple-touch-icon" sizes="144x144" href="https://ontimize.github.io/newdocs/v1/assets/icons/apple-icon-144x144.png?v=M44lzPylqQ"> <link rel="apple-touch-icon" sizes="152x152" href="https://ontimize.github.io/newdocs/v1/assets/icons/apple-icon-152x152.png?v=M44lzPylqQ"> <link rel="apple-touch-icon" sizes="180x180" href="https://ontimize.github.io/newdocs/v1/assets/icons/apple-icon-180x180.png?v=M44lzPylqQ"> <link rel="icon" type="image/png" href="https://ontimize.github.io/newdocs/v1/assets/icons/favicon-16x16.png?v=M44lzPylqQ" sizes="16x16"> <link rel="icon" type="image/png" href="https://ontimize.github.io/newdocs/v1/assets/icons/favicon-32x32.png?v=M44lzPylqQ" sizes="32x32"> <link rel="icon" type="image/png" href="https://ontimize.github.io/newdocs/v1/assets/icons/favicon-96x96.png?v=M44lzPylqQ" sizes="96x96"> <link rel="icon" type="image/png" href="https://ontimize.github.io/newdocs/v1/assets/icons/android-icon-192x192.png?v=M44lzPylqQ" sizes="192x192"> <link rel="manifest" href="https://ontimize.github.io/newdocs/v1/assets/icons/manifest.json?v=M44lzPylqQ"> <link rel="shortcut icon" href="/assets/icons/favicon.ico?v=M44lzPylqQ"> <meta name="msapplication-TileColor" content="#000000"> <meta name="msapplication-TileImage" content="https://ontimize.github.io/newdocs/v1/assets/icons/mstile-144x144.png?v=M44lzPylqQ"> <meta name="msapplication-config" content="https://ontimize.github.io/newdocs/v1/assets/icons/browserconfig.xml?v=M44lzPylqQ"> <meta name="theme-color" content="#ffffff"> <link rel="preconnect" href="https://fonts.googleapis.com"> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet"> <link rel="stylesheet" href="https://ontimize.github.io/newdocs/v1/assets/jstree/style.min.css" /> <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.1/jquery.min.js"></script> <script src="https://ontimize.github.io/newdocs/v1/assets/jstree/jstree.min.js"></script> <script>$(document).ready(function () { $('.jstreeloader').jstree(); });</script> <!-- end custom head snippets --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/newdocs/v1/" class="site-title lh-tight"> <div class="site-logo" role="img" aria-label="Ontimize Boot"></div> </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/newdocs/v1/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/newdocs/v1/introduction/" class="nav-list-link">Introduction</a></li><li class="nav-list-item"><a href="/newdocs/v1/getting_started/" class="nav-list-link">Getting started</a></li><li class="nav-list-item"><a href="/newdocs/v1/basics/autoconfigurators/" class="nav-list-link">Autoconfigurators</a></li><li class="nav-list-item"><a href="/newdocs/v1/basics/dms/" class="nav-list-link">DMS System</a></li><li class="nav-list-item"><a href="/newdocs/v1/basics/i18n/" class="nav-list-link">I18N System</a></li><li class="nav-list-item"><a href="/newdocs/v1/basics/ldap/" class="nav-list-link">LDAP Security</a></li><li class="nav-list-item"><a href="/newdocs/v1/basics/mail/" class="nav-list-link">Mail System</a></li><li class="nav-list-item"><a href="/newdocs/v1/basics/" class="nav-list-link">Ontimize Basics</a></li><li class="nav-list-item"><a href="/newdocs/v1/basics/security/" class="nav-list-link">Security System</a></li><li class="nav-list-item"><a href="/newdocs/v1/basics/applicationyml/" class="nav-list-link">Understanding application.yml</a></li><li class="nav-list-item"><a href="/newdocs/v1/basics/complexqueries/" class="nav-list-link">Using complex queries</a></li></ul> </nav> <footer class="site-footer"> © 2023 Imatia Innovation, S.L. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Ontimize Boot" aria-label="Search Ontimize Boot" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <div class="header-custom-main"> <div class="github-div"> <a href="https://github.com/Ontimize" target="_blank"> <img src="https://ontimize.github.io/newdocs/v1/assets/icons/github-front.svg" width="42px" height="42px" alt="Ontimize"> </a> </div> <select class="select" name="version" onchange="window.open(this.value,'_self')"> <option value="https://ontimize.github.io/newdocs/v1" selected> 1.x.x </option> <option value="https://ontimize.github.io/newdocs/v3" > 3.x.x </option> </select> </div> </div> <div class="main-content-wrap"> <div id="main-content" class="main-content"> <main> <aside class="sidebar__right"> <nav class="toc"><header> <h4 class="nav__title"> Table of Contents </h4> </header> <ul class="toc__menu" id="markdown-toc"> <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li> <li><a href="#prerequisites" id="markdown-toc-prerequisites">Prerequisites</a></li> <li><a href="#steps" id="markdown-toc-steps">Steps</a> <ul> <li><a href="#add-new-profile-and-user" id="markdown-toc-add-new-profile-and-user">Add new profile and user</a></li> <li><a href="#modify-the-service-to-add-security" id="markdown-toc-modify-the-service-to-add-security">Modify the service to add security</a></li> <li><a href="#add-permissions-for-methods" id="markdown-toc-add-permissions-for-methods">Add permissions for methods</a></li> </ul> </li> </ul> </nav> </aside> <h1 id="introduction"> <a href="#introduction" class="anchor-heading" aria-labelledby="introduction"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Introduction </h1> <p>Ontimize security allows you to set permissions to each role that you assign to a specific user, so that different users can access (or not) the project services and methods.</p> <h1 id="prerequisites"> <a href="#prerequisites" class="anchor-heading" aria-labelledby="prerequisites"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prerequisites </h1> <p>You can follow this tutorial using your own application, although for this example we will use an application created using the archetype that can be found <a href="https://ontimize.github.io/newdocs/v1/getting_started/">on this page</a> and with a REST service.</p> <p>There are 2 options to follow this tutorial, clone the repository with the initial state and follow the tutorial step by step, or download the final example and see which files are new and which have been updated.</p> <div class="multiColumnRow multiColumnRowJustify"> <div class="multiColumn multiColumnGrow"> <p><strong>Initial project</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/$ git clone https://github.com/ontimize/ontimize-examples
/ontimize-examples$ cd ontimize-examples
/ontimize-examples$ git checkout boot-security-1.x.x-initial
</code></pre></div></div> </div> <div class="verticalDivider"></div> <div class="multiColumn multiColumnGrow"> <p><strong>Final example</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/$ git clone https://github.com/ontimize/ontimize-examples
/ontimize-examples$ cd ontimize-examples
/ontimize-examples$ git checkout boot-security-1.x.x
</code></pre></div></div> </div> </div> <blockquote class="note"> <p>To simplify the code being written, three dots (&#8230;) may appear in some parts of the code. This indicates that there may be previous code before and after those dots.</p> </blockquote> <h1 id="steps"> <a href="#steps" class="anchor-heading" aria-labelledby="steps"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Steps </h1> <h2 id="add-new-profile-and-user"> <a href="#add-new-profile-and-user" class="anchor-heading" aria-labelledby="add-new-profile-and-user"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Add new profile and user </h2> <p>We will add the following elements to the database:</p> <ul> <li>New user</li> </ul> <figure class="highlight"><pre><code class="language-sql" data-lang="sql">  <span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TUSER</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'candidate'</span><span class="p">,</span><span class="s1">'candidate'</span><span class="p">,</span><span class="s1">'candidate'</span><span class="p">,</span><span class="s1">'candidate'</span><span class="p">,</span><span class="k">NULL</span><span class="p">,</span><span class="s1">'99999999R'</span><span class="p">,</span><span class="k">NULL</span><span class="p">,</span><span class="s1">'2020-07-03 11:50:40.665000'</span><span class="p">,</span><span class="k">NULL</span><span class="p">)</span>
  </code></pre></figure> <ul> <li>New user role</li> </ul> <figure class="highlight"><pre><code class="language-sql" data-lang="sql">  <span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TROLE</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">'candidate'</span><span class="p">,</span><span class="s1">'&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;security&gt;&lt;/security&gt;'</span><span class="p">)</span>
  </code></pre></figure> <ul> <li>Relationship between the new user and the new role</li> </ul> <figure class="highlight"><pre><code class="language-sql" data-lang="sql">  <span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TUSER_ROLE</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">'candidate'</span><span class="p">)</span>
  </code></pre></figure> <h2 id="modify-the-service-to-add-security"> <a href="#modify-the-service-to-add-security" class="anchor-heading" aria-labelledby="modify-the-service-to-add-security"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Modify the service to add security </h2> <p>In the <em>projectwiki-boot</em> module we will add the annotation <code class="language-plaintext highlighter-rouge">@EnableAspectJAutoProxy(proxyTargetClass = false)</code> to the <strong>ServerApplication.java</strong> class and to each service method the <code class="language-plaintext highlighter-rouge">@Secured({ PermissionsProviderSecured.SECURED })</code> annotation.</p> <div class="multiColumnRow"> <div class="multiColumn jstreeloader"> <ul> <li data-jstree="{&quot;opened&quot;:true, &quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> ontimize-examples <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> projectwiki-api <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> src <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> main <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> java <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> com <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> ontimize <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> projectwiki <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> api <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> core <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> service <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">ICandidateService.java</li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">IUserService.java</li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">pom.xml</li> </ul> </li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> projectwiki-boot <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> src <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> main <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> java <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> com <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> ontimize <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> projectwiki <ul> <li data-jstree="{&quot;selected&quot;: true, &quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">ServerApplication.java</li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> resources <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">application.yml</li> </ul> </li> </ul> </li> </ul> </li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">pom.xml</li> </ul> </li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> projectwiki-model <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> src <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> main <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> db <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">templateDB.properties</li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">templateDB.txt</li> </ul> </li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> java <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> com <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> ontimize <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> projectwiki <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> model <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> core <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> dao <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">CandidateDao.java</li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">UserDao.java</li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">UserRoleDao.java</li> </ul> </li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> service <ul> <li data-jstree="{&quot;selected&quot;: true, &quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">CandidateService.java</li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">UserService.java</li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> resources <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> dao <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">CandidateDao.xml</li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">placeholders.properties</li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">RoleDao.xml</li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">RoleServerPermissionDao.xml</li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">ServerPermissionDao.xml</li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">UserDao.xml</li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">UserRoleDao.xml</li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">pom.xml</li> </ul> </li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> projectwiki-ws <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> src <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> main <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> java <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> com <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> ontimize <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> projectwiki <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> ws <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> core <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-folder-open.svg&quot;}"> rest <ul> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">CandidateRestController.java</li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">MainRestController.java</li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">TestRestController.java</li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">UserRestController.java</li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">pom.xml</li> </ul> </li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">pom.xml</li> <li data-jstree="{&quot;icon&quot;:&quot;https://ontimize.github.io/newdocs/v1/assets/jstree/fa-file.svg&quot;}">README.md</li> </ul> </li> </ul> </div> <div class="multiColumn multiColumnGrow"> <p><strong>ServerApplication.java</strong></p> <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.ontimize.projectwiki</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.EnableAspectJAutoProxy</span><span class="o">;</span>

<span class="nd">@SpringBootApplication</span>
<span class="nd">@EnableAspectJAutoProxy</span><span class="o">(</span><span class="n">proxyTargetClass</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ServerApplication</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    	<span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">ServerApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre></figure> <p><strong>CustomerService.java</strong></p> <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.ontimize.projectwiki.model.core.service</span><span class="o">;</span>

<span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.access.annotation.Secured</span><span class="o">;</span>

<span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
<span class="kn">import</span> <span class="nn">com.ontimize.jee.common.security.PermissionsProviderSecured</span><span class="o">;</span>

<span class="o">.</span> <span class="o">.</span> <span class="o">.</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CandidateService</span> <span class="kd">implements</span> <span class="nc">ICandidateService</span> <span class="o">{</span>

<span class="o">.</span> <span class="o">.</span> <span class="o">.</span>

    <span class="nd">@Override</span>
    <span class="nd">@Secured</span><span class="o">({</span> <span class="nc">PermissionsProviderSecured</span><span class="o">.</span><span class="na">SECURED</span> <span class="o">})</span>
    <span class="kd">public</span> <span class="nc">EntityResult</span> <span class="nf">candidateQuery</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">keyMap</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">attrList</span><span class="o">)</span>
    		<span class="kd">throws</span> <span class="nc">OntimizeJEERuntimeException</span> <span class="o">{</span>
    	<span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">daoHelper</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">candidateDao</span><span class="o">,</span> <span class="n">keyMap</span><span class="o">,</span> <span class="n">attrList</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="nd">@Secured</span><span class="o">({</span> <span class="nc">PermissionsProviderSecured</span><span class="o">.</span><span class="na">SECURED</span> <span class="o">})</span>
    <span class="nd">@Transactional</span><span class="o">(</span><span class="n">rollbackFor</span> <span class="o">=</span> <span class="nc">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">EntityResult</span> <span class="nf">candidateInsert</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">attrMap</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">OntimizeJEERuntimeException</span> <span class="o">{</span>
    	<span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">daoHelper</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">candidateDao</span><span class="o">,</span> <span class="n">attrMap</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="nd">@Secured</span><span class="o">({</span> <span class="nc">PermissionsProviderSecured</span><span class="o">.</span><span class="na">SECURED</span> <span class="o">})</span>
    <span class="nd">@Transactional</span><span class="o">(</span><span class="n">rollbackFor</span> <span class="o">=</span> <span class="nc">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">EntityResult</span> <span class="nf">candidateUpdate</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">attrMap</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">keyMap</span><span class="o">)</span>
    		<span class="kd">throws</span> <span class="nc">OntimizeJEERuntimeException</span> <span class="o">{</span>
    	<span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">daoHelper</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">candidateDao</span><span class="o">,</span> <span class="n">attrMap</span><span class="o">,</span> <span class="n">keyMap</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="nd">@Secured</span><span class="o">({</span> <span class="nc">PermissionsProviderSecured</span><span class="o">.</span><span class="na">SECURED</span> <span class="o">})</span>
    <span class="kd">public</span> <span class="nc">EntityResult</span> <span class="nf">candidateDelete</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">keyMap</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">OntimizeJEERuntimeException</span> <span class="o">{</span>
    	<span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">daoHelper</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">candidateDao</span><span class="o">,</span> <span class="n">keyMap</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre></figure> </div> </div> <h2 id="add-permissions-for-methods"> <a href="#add-permissions-for-methods" class="anchor-heading" aria-labelledby="add-permissions-for-methods"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Add permissions for methods </h2> <p>Once the methods have been noted, it is necessary to add the service and the method that we have noted to the table of the DB that stores those elements and to the table that indicates the methods for which the role has permission.</p> <figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSERVER_PERMISSION</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'com.ontimize.projectwiki.model.core.service.CandidateService/candidateQuery'</span><span class="p">)</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSERVER_PERMISSION</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'com.ontimize.projectwiki.model.core.service.CandidateService/candidateInsert'</span><span class="p">)</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSERVER_PERMISSION</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'com.ontimize.projectwiki.model.core.service.CandidateService/candidateUpdate'</span><span class="p">)</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSERVER_PERMISSION</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'com.ontimize.projectwiki.model.core.service.CandidateService/candidateDelete'</span><span class="p">)</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TROLE_SERVER_PERMISSION</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TROLE_SERVER_PERMISSION</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TROLE_SERVER_PERMISSION</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TROLE_SERVER_PERMISSION</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span></code></pre></figure> <p>If we try to make requests through <a href="https://www.postman.com/">Postman</a> to the service of CandidateService, changing the authentication by the user candidate and password candidate, it will give an error, since the user candidate does not belong to the role admin which is the only role that has permissions to make these queries.</p> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
